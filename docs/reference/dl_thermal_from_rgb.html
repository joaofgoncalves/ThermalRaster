<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Enhances the resolution or predicts thermal data based on high-resolution RGB images
and an existing low-resolution thermal raster using a deep learning model. The model
is trained on features derived from the RGB and low-resolution thermal data, optionally
scaled and with high correlation features removed. The function can then predict
thermal data aligned with a provided high-resolution RGB image, effectively
super-resolving the thermal image or generating new thermal data where none exists."><title>Predict thermal data from RGB images using Deep Learning — dl_thermal_from_rgb • ThermalRaster</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.8/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict thermal data from RGB images using Deep Learning — dl_thermal_from_rgb"><meta property="og:description" content="Enhances the resolution or predicts thermal data based on high-resolution RGB images
and an existing low-resolution thermal raster using a deep learning model. The model
is trained on features derived from the RGB and low-resolution thermal data, optionally
scaled and with high correlation features removed. The function can then predict
thermal data aligned with a provided high-resolution RGB image, effectively
super-resolving the thermal image or generating new thermal data where none exists."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ThermalRaster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Predict thermal data from RGB images using Deep Learning</h1>
      
      <div class="d-none name"><code>dl_thermal_from_rgb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Enhances the resolution or predicts thermal data based on high-resolution RGB images
and an existing low-resolution thermal raster using a deep learning model. The model
is trained on features derived from the RGB and low-resolution thermal data, optionally
scaled and with high correlation features removed. The function can then predict
thermal data aligned with a provided high-resolution RGB image, effectively
super-resolving the thermal image or generating new thermal data where none exists.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dl_thermal_from_rgb</span><span class="op">(</span></span>
<span>  <span class="va">rgb_rst</span>,</span>
<span>  <span class="va">temp_rst</span>,</span>
<span>  rgb_high_res <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  npix <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  rm_cor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rm_cor_thresh <span class="op">=</span> <span class="fl">0.98</span>,</span>
<span>  get_dl_model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale_data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_epochs <span class="op">=</span> <span class="fl">80</span>,</span>
<span>  validation_split <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  learning_rate <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>rgb_rst</dt>
<dd><p>An RGB `SpatRaster` object containing RGB data aligned with `temp_rst`.</p></dd>


<dt>temp_rst</dt>
<dd><p>A `SpatRaster` object containing corresponding lower-resolution
thermal data.</p></dd>


<dt>rgb_high_res</dt>
<dd><p>(Optional) A `SpatRaster` object containing high-resolution
RGB data for which thermal predictions are to be made.</p></dd>


<dt>npix</dt>
<dd><p>The number of pixels to sample for model training.</p></dd>


<dt>rm_cor</dt>
<dd><p>Logical flag indicating whether to remove highly correlated features
before model training.</p></dd>


<dt>rm_cor_thresh</dt>
<dd><p>Correlation threshold for removing correlated features.</p></dd>


<dt>get_dl_model</dt>
<dd><p>Logical flag indicating whether to return the deep learning
model along with the predicted temperature raster(s).</p></dd>


<dt>verbose</dt>
<dd><p>Logical flag for printing progress messages.</p></dd>


<dt>scale_data</dt>
<dd><p>Logical flag indicating whether to scale the feature data before
model training.</p></dd>


<dt>n_epochs</dt>
<dd><p>Number of epochs for model training.</p></dd>


<dt>validation_split</dt>
<dd><p>Fraction of the data to be used as validation data.</p></dd>


<dt>learning_rate</dt>
<dd><p>Learning rate for the optimizer.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Depending on `get_dl_model`, either a list containing the predicted
        temperature raster(s) and the deep learning model, or just the predicted
        temperature raster(s). If `rgb_high_res` is provided, the list will include
        predictions for both the training resolution and the high-resolution RGB.
        List components include: `pred_temp_train` is the thermal image predicted
        for the training data (usually with lower resolution); `pred_temp_rgb_hr`
        is the predicted thermal data for the high-resolution RGB; `dl_mod` is the
        Deep Learning model trained for the image.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The deep learning model used for predicting thermal data from high-resolution RGB
images is built using the Keras library in R. This model is structured as a sequential
model, comprising several densely connected neural network layers with ReLU activations,
dropout layers for regularization, and a final dense layer with a single unit for
regression output. The model aims to learn complex relationships between spatial features
derived from RGB images and corresponding thermal data, allowing it to predict temperature
values for new, high-resolution RGB images.</p>
<p>Model Structure</p>
<p>Input Layer: The input layer is designed to accept the flattened feature vectors derived
from the color/spatial/texture features of RGB and thermal data.</p>
<p>The model includes multiple dense (fully connected) layers with ReLU (Rectified Linear Unit)
activation functions. These layers are responsible for capturing nonlinear relationships in
the data.</p>
<p>Dropout layers are inserted between dense layers to reduce the risk of overfitting by randomly
setting a fraction of input units to 0 at each update during training time. This helps improve
model generalization.</p>
<p>Activity regularization layers are applied to introduce a penalty on the layer's activation,
further aiding in preventing overfitting and promoting simpler models.</p>
<p>Output Layer: The final layer is a dense layer with a single unit, suitable for regression tasks.
This layer outputs the predicted temperature value for each input feature vector.</p>
<p>Training Configuration</p>
<p>Loss Function: Mean Squared Error (MSE), suitable for regression problems, measuring the average
of the squares of the errors between true and predicted values.</p>
<p>Optimizer: Adam, with a specified learning rate, an algorithm for first-order gradient-based
optimization of stochastic objective functions. Metrics: Mean Absolute Error (MAE), providing an
average of absolute differences between predicted and actual values, offering an interpretation
of prediction accuracy.</p>
<p>Epochs and Validation Split: The model is trained for a predefined number of epochs, with a portion
of the data reserved for validation to monitor and prevent overfitting.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Joao Goncalves.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

